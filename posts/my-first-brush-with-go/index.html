<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My First Brush With Go | Random Musings</title><meta name=keywords content><meta name=description content="I have decided to try out Golang. In this post I share my initial experience of setting up relevant tooling and writing my first ever Go script."><meta name=author content><link rel=canonical href=https://www.sayemahmed.com/posts/my-first-brush-with-go/><link crossorigin=anonymous href=/assets/css/stylesheet.75e99ced767a858315a7f7639cf847a348c9cd6d87c9dfe94262be72551a789f.css integrity="sha256-demc7XZ6hYMVp/djnPhHo0jJzW2Hyd/pQmK+clUaeJ8=" rel="preload stylesheet" as=style><link rel=icon href=https://www.sayemahmed.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.sayemahmed.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.sayemahmed.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.sayemahmed.com/apple-touch-icon.png><link rel=mask-icon href=https://www.sayemahmed.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="My First Brush With Go"><meta property="og:description" content="I have decided to try out Golang. In this post I share my initial experience of setting up relevant tooling and writing my first ever Go script."><meta property="og:type" content="article"><meta property="og:url" content="https://www.sayemahmed.com/posts/my-first-brush-with-go/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-14T21:39:58+01:00"><meta property="article:modified_time" content="2023-03-14T21:39:58+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="My First Brush With Go"><meta name=twitter:description content="I have decided to try out Golang. In this post I share my initial experience of setting up relevant tooling and writing my first ever Go script."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.sayemahmed.com/posts/"},{"@type":"ListItem","position":2,"name":"My First Brush With Go","item":"https://www.sayemahmed.com/posts/my-first-brush-with-go/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My First Brush With Go","name":"My First Brush With Go","description":"I have decided to try out Golang. In this post I share my initial experience of setting up relevant tooling and writing my first ever Go script.","keywords":[],"articleBody":"I have decided to have a go at Go (pun intended!).\nThe reasons are less important than the decision itself, so I will not discuss them in this blog. Instead, I will focus on the journey and will document the experience in a series of posts (hopefully, more to come!).\nAnyone who has worked with a programming language professionally knows that learning a programming language involves more than learning syntax. Here is a list of things that I feel I need to learn if I want to be productive in Go (in no particular order) -\nSetting up relevant tools and being comfortable with them The language syntax Language APIs Writing tests 3rd party libraries and frameworks Debugging in Go Compiling and packaging applications with Go Set up CI/CD Different failure modes and language quarks and learning how to watch out for them Monitoring for failures, including learning how to collect metrics I am currently at stage 2, trying to learn the language syntax. I expect to jump back and forth between different stages as I continue learning Go.\nInstalling Go Installing Go on my machine was relatively easy as I am on a Mac. All I had to do was use brew:\nbrew install go I verified my Go installation with:\ngo version which printed:\ngo version go1.20.1 darwin/arm64 Writing my first hello world script Next, it was time to write my first ever hello world in Go. I used Visual Studio Code to create a file named hello.go with the following content -\n// Go organises code in packages! Similar to Java package main // I can import other packages and reuse their code import \"fmt\" // This is how I can define a function in Go func main() { fmt.Print(\"Hello World\\n\") } Now it is time to compile and run the code. I opened up the terminal, navigated to the directory containing the file, and executed:\ngo run hello.go The go run command compiled my script, built a native binary, and simultaneously executed it. Which then printed the expected output in the command line:\nHello World Success!\nLike Java, Go also has the concept of packages. I am still not fully aware of all the rules and gotchas, but I assume their purpose is similar to Java - they have been designed to group relevant code under a common namespace.\nI also learned that packages could decide to expose functions/variables to other packages. To do that, I have to define a function with a capital letter, and Go automatically assumes that it is intended to be used from other packages. This is why the Print function starts with a capital P.\nAnother observation is that if I change my package name to something else, like hellopackage, the code no longer compiles. Instead, I get the following error message:\npackage command-line-arguments is not a main package The package containing the main function must also be named main. This makes me wonder how people organise code in Go. Do they use reversed company domain name to name packages (i.e., com.sayemahmed) and then have only one package named main with only the main function to bootstrap the application? Or do they use something else?\ngo build go run isn’t the only way to build a Go script. We have another command at our disposal - go build - which compiles the script and generates a native executable binary:\ngo build -o hello_world hello.go I used the -o flag to specify a name for the binary file.\nThe compilation process reminded me of how I used to compile C/C++ files with GCC (gcc hello.c -o hello would be equivalent for a C file). With Java, however, I hardly needed to generate a native binary file (though I could, using GraalVM). Most of the times I have used Maven to build and deploy my web applications.\nWhat are the differences between go run and go build? The go run command takes either a single file, a list of files, or the name of a package. It then compiles the code and creates a native binary file in a temporary directory, executes the binary, and then deletes it immediately.\nThe go build command also takes either a single file, a list of files, or the name of a package. However, it only compiles the code and creates a native binary. We can use the -o flag with this command to set the name of the compiled binary.\nBuilt-in tools Besides the compiler, Go comes with many helpful tools with default installation. One such tool is go fmt which reformats code based on official standards. I was pleased to find out Go has an officially recommended formatting which is enforced during compile time! Ha! No more fighting over tabs vs spaces!!\nThe reason Go comes with standardised formatting seems to be easier tooling support. People claim that it makes it easy to write tools that manipulate Go source code, which makes it easy to write code generation tools. Nice.\nSimilar to a formatter, Go installation also includes a linter, a dependency manager, and a test runner. I have yet to try them out.\nMy first real script A few weeks ago, I needed to prepare a report. The report contained some information I collected over the last year. It was a ~500 lines file, and I wanted to check it had no duplicates before submitting it. I wrote a Go script to automate the process. The entire script is given below:\npackage main import ( \"bufio\" \"fmt\" \"os\" \"strings\" ) func main() { // First argument is the full path to the binary when // executed with `go run` if len(os.Args) != 2 { fmt.Println(\"Usage: \") return } fileName := os.Args[1] readFile, err := os.Open(fileName) if err != nil { fmt.Println(\"Error while trying to open file\", err) } fileScanner := bufio.NewScanner(readFile) fileScanner.Split(bufio.ScanLines) // https://stackoverflow.com/a/34020023 set := make(map[string]struct{}) // https://dave.cheney.net/2014/03/25/the-empty-struct var empty struct{} for fileScanner.Scan() { line := strings.TrimSpace(fileScanner.Text()) if line == \"\" { continue } _, found := set[line] if found { fmt.Println(\"Duplicate exists: \", line) } else { set[line] = empty } } readFile.Close() } I invoked the script as follows:\ngo run my-script.go ~/Documents/my-report.md Which then displayed all the duplicate lines in my-report.md file.\nI first learned how to pass command line arguments to a Go script. To do that, I needed to import the built-in os package and use it’s Args array. It looks like arrays in Go work similarly to Java and C - zero-based and indexed using []. The first element contains the executable’s name (in my case, it was something like /var/folders/mr/k_b0wtwd11q66p3z3787w9082200gq/T/go-build907299260/b001/exe/my-script). Starting from the second element, we can access any passed-in arguments. The script expects the file name, which should be checked for duplicates, so we access the file name at index 1.\nNext, I learned that to find the length of an array, I need to use the built-in len function. This is similar to how the len function in Python works.\nThe line:\nfileName := os.Args[1] declares and simultaneously initialises a variable named fileName with the name of our file. Go seems to allow a couple of ways to declare variables - one using var and the other without it. The above line for example could have also been written as:\n// Declare the variable first, with explicit type var fileScanner *bufio.Scanner // Initialise the variable fileScanner = bufio.NewScanner(readFile) There are some differences between the two approaches. For example, we can only use := within a function. It can also infer the variable type automatically as we are required to specify a value immediately.\nOn the other hand, we can use = outside a function as well. It also cannot infer the type of a variable automatically.\nWhen I saw the * in the type, I started thinking - does Go have explicit pointers like C? And it seems it does! That means caring about Dangling Pointers and SegFaults and memory safety and all that!\nThe following line opens the file for reading:\nreadFile, err := os.Open(fileName) I didn’t specify file open (i.e., read-write/append only/read-only) mode when calling Open, but I assume there must be a way to do it.\nOne interesting thing to note is how I used two variables to store the return values from Open. It looks similar to how Python can return multiple values from a method (which it converts into a Tuple). I am not 100% sure whether something similar is happening here. The Go by Example site mentions multiple return values, but it doesn’t explain how it actually works under the hood.\nAlso, after looking at some examples, it seems many functions in Go often return a couple of return values, especially the ones that do some I/O or have a chance of running into errors/issues. In Java, we used to throw exceptions when an I/O failed, but in Go, the convention is to return a second value describing the error.\nThe following two lines:\nfileScanner := bufio.NewScanner(readFile) fileScanner.Split(bufio.ScanLines) instantiates and configures something like a Scanner to read the file line by line.\nMy initial idea was to create a Set where I store the lines after reading from the file. Then, if I ever find another matching line by doing a simple contains check, I have found a duplicate. While trying to translate this idea into Go code, I discovered that it does not have any built-in Set type. It does have a Map, and the recommendation was to use it to simulate a Set, which I did:\nset := make(map[string]struct{}) I also came across empty struct. It seems Go does not have anything that looks like a Java class, but it does have Structures like in C. An empty struct is a special kind of structure in that it does not occupy any memory. And so, simulating a Set of strings with a Map of String to empty struct was the most space-efficient way.\nThe next few lines are relatively easy to understand - we stream through the lines in the files and check for duplicates. The interesting bit here is the line:\n_, found := set[line] which shows that, like some programming languages i.e., Scala Go also supports _ as a way to ignore values when we don’t care about them.\nFinal thoughts After writing my first script, my first impression was that Go is between C and Java. It has pointers like in C, and it has packages like Java. Its similarity to C might be why people often say that Go applications have less resource footprint. On the other hand, I wonder if Go has something like a Spring-framework, which removes a lot of boilerplate for anyone developing applications in Java.\nBut all in all, I like my initial brush with Go.\n","wordCount":"1799","inLanguage":"en","datePublished":"2023-03-14T21:39:58+01:00","dateModified":"2023-03-14T21:39:58+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sayemahmed.com/posts/my-first-brush-with-go/"},"publisher":{"@type":"Organization","name":"Random Musings","logo":{"@type":"ImageObject","url":"https://www.sayemahmed.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.sayemahmed.com accesskey=h title="Random Musings (Alt + H)">Random Musings</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.sayemahmed.com/about-me title="About Me"><span>About Me</span></a></li><li><a href=https://www.sayemahmed.com/index.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">My First Brush With Go</h1><div class=post-description>I have decided to try out Golang. In this post I share my initial experience of setting up relevant tooling and writing my first ever Go script.</div><div class=post-meta><span title='2023-03-14 21:39:58 +0100 CET'>March 14, 2023</span></div></header><div class=post-content><p>I have decided to have a go at Go (pun intended!).</p><p>The reasons are less important than the decision itself, so I will not discuss them in this blog. Instead, I will focus on the journey and will document the experience in a series of posts (hopefully, more to come!).</p><p>Anyone who has worked with a programming language professionally knows that learning a programming language involves more than learning syntax. Here is a list of things that I feel I need to learn if I want to be productive in Go (in no particular order) -</p><ol><li>Setting up relevant tools and being comfortable with them</li><li>The language syntax</li><li>Language APIs</li><li>Writing tests</li><li>3rd party libraries and frameworks</li><li>Debugging in Go</li><li>Compiling and packaging applications with Go</li><li>Set up CI/CD</li><li>Different failure modes and language quarks and learning how to watch out for them</li><li>Monitoring for failures, including learning how to collect metrics</li></ol><p>I am currently at stage 2, trying to learn the language syntax. I expect to jump back and forth between different stages as I continue learning Go.</p><h1 id=installing-go>Installing Go<a hidden class=anchor aria-hidden=true href=#installing-go>#</a></h1><p>Installing Go on my machine was relatively easy as I am on a Mac. All I had to do was use <code>brew</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>brew install go
</span></span></code></pre></div><p>I verified my Go installation with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go version
</span></span></code></pre></div><p>which printed:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go version go1.20.1 darwin/arm64
</span></span></code></pre></div><h1 id=writing-my-first-hello-world-script>Writing my first hello world script<a hidden class=anchor aria-hidden=true href=#writing-my-first-hello-world-script>#</a></h1><p>Next, it was time to write my first ever hello world in Go. I used Visual Studio Code to create a file named <code>hello.go</code> with the following content -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Go organises code in packages! Similar to Java
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// I can import other packages and reuse their code
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// This is how I can define a function in Go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;Hello World\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Now it is time to compile and run the code. I opened up the terminal, navigated to the directory containing the file, and executed:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go run hello.go
</span></span></code></pre></div><p>The <code>go run</code> command compiled my script, built a native binary, and simultaneously executed it. Which then printed the expected output in the command line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>Hello World
</span></span></code></pre></div><p>Success!</p><p>Like Java, Go also has the concept of packages. I am still not fully aware of all the rules and gotchas, but I assume their purpose is similar to Java - they have been designed to group relevant code under a common namespace.</p><p>I also learned that packages could decide to expose functions/variables to other packages. To do that, I have to define a function with a capital letter, and Go automatically assumes that it is intended to be used from other packages. This is why the <code>Print</code> function starts with a capital <code>P</code>.</p><p>Another observation is that if I change my package name to something else, like <code>hellopackage</code>, the code no longer compiles. Instead, I get the following error message:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>package command-line-arguments is not a main package
</span></span></code></pre></div><p>The package containing the <code>main</code> function must also be named <code>main</code>. This makes me wonder how people organise code in Go. Do they use reversed company domain name to name packages (i.e., <code>com.sayemahmed</code>) and then have only one package named <code>main</code> with only the <code>main</code> function to bootstrap the application? Or do they use something else?</p><h2 id=go-build><code>go build</code><a hidden class=anchor aria-hidden=true href=#go-build>#</a></h2><p><code>go run</code> isn&rsquo;t the only way to build a Go script. We have another command at our disposal - <code>go build</code> - which compiles the script and generates a native executable binary:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go build -o hello_world hello.go
</span></span></code></pre></div><p>I used the <code>-o</code> flag to specify a name for the binary file.</p><p>The compilation process reminded me of how I used to compile C/C++ files with <a href=https://gcc.gnu.org/>GCC</a> (<code>gcc hello.c -o hello</code> would be equivalent for a C file). With Java, however, I hardly needed to generate a native binary file (though I could, using GraalVM). Most of the times I have used Maven to build and deploy my web applications.</p><p>What are the differences between <code>go run</code> and <code>go build</code>? The <code>go run</code> command takes either a single file, a list of files, or the name of a package. It then compiles the code and creates a native binary file in a temporary directory, executes the binary, and then deletes it immediately.</p><p>The <code>go build</code> command also takes either a single file, a list of files, or the name of a package. However, it only compiles the code and creates a native binary. We can use the <code>-o</code> flag with this command to set the name of the compiled binary.</p><h1 id=built-in-tools>Built-in tools<a hidden class=anchor aria-hidden=true href=#built-in-tools>#</a></h1><p>Besides the compiler, Go comes with many helpful tools with default installation. One such tool is <code>go fmt</code> which reformats code based on official standards. I was pleased to find out Go has an officially recommended formatting which is enforced during compile time! Ha! No more fighting over tabs vs spaces!!</p><p>The reason Go comes with standardised formatting seems to be easier tooling support. People claim that it makes it easy to write tools that manipulate Go source code, which makes it easy to write code generation tools. Nice.</p><p>Similar to a formatter, Go installation also includes a linter, a dependency manager, and a test runner. I have yet to try them out.</p><h1 id=my-first-real-script>My first real script<a hidden class=anchor aria-hidden=true href=#my-first-real-script>#</a></h1><p>A few weeks ago, I needed to prepare a report. The report contained some information I collected over the last year. It was a ~500 lines file, and I wanted to check it had no duplicates before submitting it. I wrote a Go script to automate the process. The entire script is given below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// First argument is the full path to the binary when
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// executed with `go run`
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Usage: &lt;exeutable&gt; &lt;full-path&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fileName</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nx>readFile</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>fileName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error while trying to open file&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fileScanner</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>readFile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fileScanner</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=nx>bufio</span><span class=p>.</span><span class=nx>ScanLines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// https://stackoverflow.com/a/34020023
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>set</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// https://dave.cheney.net/2014/03/25/the-empty-struct
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>var</span> <span class=nx>empty</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>fileScanner</span><span class=p>.</span><span class=nf>Scan</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>line</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>TrimSpace</span><span class=p>(</span><span class=nx>fileScanner</span><span class=p>.</span><span class=nf>Text</span><span class=p>())</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>line</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>continue</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=nx>_</span><span class=p>,</span> <span class=nx>found</span> <span class=o>:=</span> <span class=nx>set</span><span class=p>[</span><span class=nx>line</span><span class=p>]</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>found</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Duplicate exists: &#34;</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>set</span><span class=p>[</span><span class=nx>line</span><span class=p>]</span> <span class=p>=</span> <span class=nx>empty</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>readFile</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>I invoked the script as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go run my-script.go ~/Documents/my-report.md
</span></span></code></pre></div><p>Which then displayed all the duplicate lines in <code>my-report.md</code> file.</p><p>I first learned how to pass command line arguments to a Go script. To do that, I needed to import the built-in <code>os</code> package and use it&rsquo;s <code>Args</code> array. It looks like arrays in Go work similarly to Java and C - zero-based and indexed using <code>[]</code>. The first element contains the executable&rsquo;s name (in my case, it was something like <code>/var/folders/mr/k_b0wtwd11q66p3z3787w9082200gq/T/go-build907299260/b001/exe/my-script</code>). Starting from the second element, we can access any passed-in arguments. The script expects the file name, which should be checked for duplicates, so we access the file name at index 1.</p><p>Next, I learned that to find the length of an array, I need to use the built-in <code>len</code> function. This is similar to how the <a href=https://www.programiz.com/python-programming/methods/built-in/len>len function in Python works</a>.</p><p>The line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fileName</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><p>declares and simultaneously initialises a variable named <code>fileName</code> with the name of our file. Go seems to allow a couple of ways to declare variables - one using <code>var</code> and the other without it. The above line for example could have also been written as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Declare the variable first, with explicit type
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>fileScanner</span> <span class=o>*</span><span class=nx>bufio</span><span class=p>.</span><span class=nx>Scanner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Initialise the variable
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fileScanner</span> <span class=p>=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>readFile</span><span class=p>)</span>
</span></span></code></pre></div><p>There are some differences between the two approaches. For example, we can only use <code>:=</code> within a function. It can also infer the variable type automatically as we are required to specify a value immediately.</p><p>On the other hand, we can use <code>=</code> outside a function as well. It also cannot infer the type of a variable automatically.</p><p>When I saw the <code>*</code> in the type, I started thinking - <code>does Go have explicit pointers like C</code>? <a href="https://go.dev/tour/moretypes/1#:~:text=Go%20has%20pointers.,Its%20zero%20value%20is%20nil%20.">And it seems it does</a>! That means caring about <a href=https://en.wikipedia.org/wiki/Dangling_pointer>Dangling Pointers</a> and SegFaults and memory safety and all that!</p><p>The following line opens the file for reading:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>readFile</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>fileName</span><span class=p>)</span>
</span></span></code></pre></div><p>I didn&rsquo;t specify file open (i.e., read-write/append only/read-only) mode when calling <code>Open</code>, but I assume there must be a way to do it.</p><p>One interesting thing to note is how I used two variables to store the return values from <code>Open</code>. It looks similar to how Python can return multiple values from a method (which it converts into a Tuple). I am not 100% sure whether something similar is happening here. <a href=https://gobyexample.com/multiple-return-values>The Go by Example site mentions multiple return values</a>, but it doesn&rsquo;t explain how it actually works under the hood.</p><p>Also, after looking at some examples, it seems many functions in Go often return a couple of return values, especially the ones that do some I/O or have a chance of running into errors/issues. In Java, we used to throw exceptions when an I/O failed, but in Go, the convention is to return a second value describing the error.</p><p>The following two lines:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fileScanner</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>readFile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fileScanner</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=nx>bufio</span><span class=p>.</span><span class=nx>ScanLines</span><span class=p>)</span>
</span></span></code></pre></div><p>instantiates and configures something like a <a href=https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Scanner.html>Scanner</a> to read the file line by line.</p><p>My initial idea was to create a <a href=https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Set.html>Set</a> where I store the lines after reading from the file. Then, if I ever find another matching line by doing a simple <a href=https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Set.html#contains(java.lang.Object)>contains</a> check, I have found a duplicate. While trying to translate this idea into Go code, I discovered that it does not have any built-in Set type. It does have a <a href=https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Map.html>Map</a>, and the recommendation was to use it to simulate a Set, which I did:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>set</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span><span class=p>{})</span>
</span></span></code></pre></div><p>I also came across <code>empty</code> struct. It seems Go does not have anything that looks like a Java class, but it does have <a href=https://en.wikipedia.org/wiki/Struct_(C_programming_language)>Structures like in C</a>. An empty <code>struct</code> is a special kind of structure in that it does not occupy any memory. And so, simulating a Set of strings with a Map of String to empty struct was the most space-efficient way.</p><p>The next few lines are relatively easy to understand - we stream through the lines in the files and check for duplicates. The interesting bit here is the line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>_</span><span class=p>,</span> <span class=nx>found</span> <span class=o>:=</span> <span class=nx>set</span><span class=p>[</span><span class=nx>line</span><span class=p>]</span>
</span></span></code></pre></div><p>which shows that, like some programming languages <a href=https://www.baeldung.com/scala/underscore#ignoring-things>i.e., Scala</a> Go also supports <code>_</code> as a way to ignore values when we don&rsquo;t care about them.</p><h1 id=final-thoughts>Final thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h1><p>After writing my first script, my first impression was that Go is between C and Java. It has pointers like in C, and it has packages like Java. Its similarity to C might be why people often say that Go applications have less resource footprint. On the other hand, I wonder if Go has something like a <a href=https://spring.io/>Spring-framework</a>, which removes a lot of boilerplate for anyone developing applications in Java.</p><p>But all in all, I like my initial brush with Go.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://www.sayemahmed.com/posts/unwinding-the-abstraction-how-does-arraylist-in-java-work/><span class=title>Next »</span><br><span>Unwinding the Abstraction - How does ArrayList in Java Work?</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on x" href="https://x.com/intent/tweet/?text=My%20First%20Brush%20With%20Go&amp;url=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f&amp;title=My%20First%20Brush%20With%20Go&amp;summary=My%20First%20Brush%20With%20Go&amp;source=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f&title=My%20First%20Brush%20With%20Go"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on whatsapp" href="https://api.whatsapp.com/send?text=My%20First%20Brush%20With%20Go%20-%20https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on telegram" href="https://telegram.me/share/url?text=My%20First%20Brush%20With%20Go&amp;url=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share My First Brush With Go on ycombinator" href="https://news.ycombinator.com/submitlink?t=My%20First%20Brush%20With%20Go&u=https%3a%2f%2fwww.sayemahmed.com%2fposts%2fmy-first-brush-with-go%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.sayemahmed.com>Random Musings</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>